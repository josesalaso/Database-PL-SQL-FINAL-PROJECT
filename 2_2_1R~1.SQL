DECLARE
    CURSOR CUR_REG IS
        SELECT NOMBRE_REG NOM FROM REGION;
    CURSOR CUR_DATOS (NAME_REG VARCHAR2)IS
        SELECT D.RUN_POST RUNDIR, R.NOMBRE_REG NOMBRE FROM DIRECCION D
        JOIN CIUDAD C ON C.ID_DIR = D.ID_DIR
        JOIN REGION R ON C.ID_REG = R.ID_REG
        WHERE D.RUN_POST = RUN_POST;
        
V_CONT NUMBER (3);
BEGIN
    FOR REGI_CUR_REG IN CUR_REG LOOP
    V_CONT := 0;
        FOR REG_CUR_DATOS IN CUR_DATOS(REGI_CUR_REG.NOM) LOOP
            IF (REGI_CUR_REG.NOM = REG_CUR_DATOS.NOMBRE) THEN
                V_CONT := V_CONT +1;
            END IF;
        END LOOP;
        --SE INSERTA EN LA TABLA CREADA ESPECIALMENTE PARA ALMACENAR LOS POSTULANTES POR REGION.
        INSERT INTO POSTU_REGION (REGION, POSTUL) VALUES (REGI_CUR_REG.NOM,V_CONT); 
    END LOOP;
END;
/


SELECT * FROM POSTU_REGION;
