CREATE OR REPLACE PACKAGE PKG_INFO_POST IS 

    FUNCTION FN_NOMBRE_INST(PRUN NUMERIC) RETURN VARCHAR2;
    FUNCTION FN_NOMBRE_ESTCIV(PRUN NUMERIC) RETURN VARCHAR2;
    FUNCTION FN_NOMBRE_ORI(PRUN NUMERIC) RETURN VARCHAR2;
    FUNCTION FN_NOMBRE_ZONA(PRUN NUMERIC) RETURN VARCHAR2;
    V_PUNTAJE_EST NUMERIC(7);
    V_PUNTAJE_ORI NUMERIC(7);
    V_PUNTAJE_ZONA NUMERIC(7);
    V_PUNTAJE_DOC NUMERIC(7);
    
END PKG_INFO_POST;
/
create or replace PACKAGE BODY PKG_INFO_POST
IS
    FUNCTION FN_NOMBRE_INST(PRUN NUMERIC) RETURN VARCHAR2
        IS
        
            V_NOMBRE VARCHAR2 (50);
        BEGIN   
            SELECT INST.NOMBRE INTO V_NOMBRE FROM POSTULANTE P
            JOIN POSTULACION PS ON P.RUN = PS.POST_RUN
            JOIN ANTECEDENTES_POSTULACION ANT ON PS.ID_POST = ANT.ID_POSTUL
            JOIN INSTITUCION_ACADEMICA INST ON ANT.ID_INST_ACA = INST.ID_INST
            WHERE P.RUN = PRUN;
            RETURN V_NOMBRE;
    END FN_NOMBRE_INST;
    
    FUNCTION FN_NOMBRE_ESTCIV(PRUN NUMERIC) RETURN VARCHAR2
    IS
        V_NOMBRE VARCHAR2 (50);
    BEGIN
        SELECT EST.NOMBRE INTO V_NOMBRE FROM POSTULANTE P
        JOIN ESTADO_CIVIL EST ON P.ID_CIVIL = EST.ID_CIVIL
        WHERE P.RUN = PRUN;
        RETURN V_NOMBRE;
    END FN_NOMBRE_ESTCIV;
    
    FUNCTION FN_NOMBRE_ORI(PRUN NUMERIC) RETURN VARCHAR2
    IS
        V_NOMBRE VARCHAR2 (50);
    BEGIN
        SELECT P.PUEBLO_ORI INTO V_NOMBRE FROM POSTULANTE P
        WHERE P.RUN = PRUN;
        IF (V_NOMBRE IS NOT NULL) THEN
            RETURN V_NOMBRE;
        ELSE
            RETURN 'NO PERTENECE';
        END IF;
    END FN_NOMBRE_ORI;
    
    FUNCTION FN_NOMBRE_ZONA(PRUN NUMERIC) RETURN VARCHAR2
    IS
        V_NOMBRE VARCHAR2 (50);
    BEGIN
        SELECT R.NOMBRE_REG INTO V_NOMBRE FROM POSTULANTE P
        JOIN DIRECCION D ON P.RUN = D.RUN_POST
        JOIN CIUDAD C ON C.ID_DIR = D.ID_DIR
        JOIN REGION R ON C.ID_REG = R.ID_REG
        WHERE P.RUN = PRUN;
        RETURN V_NOMBRE;
    END FN_NOMBRE_ZONA;
END PKG_INFO_POST;